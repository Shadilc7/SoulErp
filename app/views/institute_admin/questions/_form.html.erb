<%= form_with(model: [:institute_admin, @question], local: true) do |f| %>
  <% if @question.errors.any? %>
    <div class="alert alert-danger">
      <h6>Please fix the following errors:</h6>
      <ul class="mb-0">
        <% @question.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row">
    <div class="col-md-12 mb-3">
      <div class="form-group">
        <%= f.label :title, class: "form-label" %>
        <%= f.text_field :title, class: "form-control" %>
      </div>
    </div>

    <div class="col-md-12 mb-3">
      <div class="form-group">
        <%= f.label :description, class: "form-label" %>
        <%= f.text_area :description, class: "form-control", rows: 3 %>
      </div>
    </div>

    <div class="col-md-6 mb-3">
      <div class="form-group">
        <%= f.label :question_type, class: "form-label" %>
        <%= f.select :question_type, 
            Question.question_types.keys.map { |t| [t.titleize, t] },
            {}, 
            { class: "form-select", data: { controller: "question-type" } } %>
      </div>
    </div>

    <div class="col-md-6 mb-3">
      <div class="form-group">
        <%= f.label :marks, class: "form-label" %>
        <%= f.number_field :marks, class: "form-control", min: 1 %>
      </div>
    </div>

    <div class="col-md-6 mb-3">
      <div class="form-group">
        <%= f.label :difficulty_level, class: "form-label" %>
        <%= f.select :difficulty_level, 
            Question.difficulty_levels.keys.map { |d| [d.titleize, d] },
            {}, 
            { class: "form-select" } %>
      </div>
    </div>

    <div class="col-md-12 mb-3" data-question-type-target="optionsContainer">
      <div class="form-group">
        <label class="form-label">Options</label>
        <div id="options-container">
          <% (@question.options || [""]).each_with_index do |option, index| %>
            <div class="input-group mb-2">
              <%= text_field_tag "question[options][]", option, class: "form-control" %>
              <button type="button" class="btn btn-outline-danger remove-option">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          <% end %>
        </div>
        <button type="button" class="btn btn-outline-custom btn-sm mt-2" id="add-option">
          <i class="bi bi-plus"></i> Add Option
        </button>
      </div>

      <div class="form-group mt-3">
        <%= f.label :correct_option, "Correct Option", class: "form-label" %>
        <%= f.number_field :correct_option, class: "form-control", min: 0 %>
      </div>
    </div>

    <div class="col-md-12 mb-3" data-question-type-target="answerContainer">
      <div class="form-group">
        <%= f.label :correct_answer, class: "form-label" %>
        <%= f.text_area :correct_answer, class: "form-control", rows: 3 %>
      </div>
    </div>

    <div class="col-12 mb-3">
      <div class="form-check">
        <%= f.check_box :active, class: "form-check-input" %>
        <%= f.label :active, class: "form-check-label" %>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <%= f.submit class: "btn btn-custom-primary" %>
    <%= link_to "Cancel", institute_admin_questions_path, class: "btn btn-outline-custom ms-2" %>
  </div>
<% end %> 