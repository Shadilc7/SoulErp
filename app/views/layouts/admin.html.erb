<!DOCTYPE html>
<html>
  <head>
    <title>SOUL ERP - Admin</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <style>
      :root {
        --sidebar-width: 280px;
        --header-height: 60px;
        --primary-color: #6366f1;
        --primary-dark: #4f46e5;
        --secondary-color: #64748b;
        --success-color: #22c55e;
        --danger-color: #ef4444;
        --warning-color: #f59e0b;
        --info-color: #3b82f6;
        --sidebar-bg: #1e293b;
        --topbar-bg: #ffffff;
        --body-bg: #f1f5f9;
        --text-primary: #f8fafc;
        --text-secondary: #94a3b8;
      }

      body {
        min-height: 100vh;
        background-color: var(--body-bg);
      }

      .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        width: var(--sidebar-width);
        background: var(--sidebar-bg);
        z-index: 1000;
        transition: transform 0.3s ease;
      }

      .sidebar-brand {
        height: var(--header-height);
        background: rgba(0, 0, 0, 0.05);
      }

      .sidebar .nav-link {
        color: var(--text-secondary);
        padding: 0.8rem 1.5rem;
        margin: 0.25rem 0.75rem;
        border-radius: 0.5rem;
        transition: all 0.2s;
        font-weight: 500;
      }

      .sidebar .nav-link:hover {
        color: var(--text-primary);
        background: rgba(255,255,255,0.1);
      }

      .sidebar .nav-link.active {
        color: var(--text-primary);
        background: var(--primary-color);
      }

      .sidebar .nav-link i {
        margin-right: 0.5rem;
        width: 1.5rem;
      }

      .main-content {
        margin-left: var(--sidebar-width);
        min-height: 100vh;
        transition: margin 0.3s ease;
      }

      .topbar {
        height: var(--header-height);
        background: var(--topbar-bg);
        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
      }

      .card-custom {
        border: none;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        transition: all 0.2s;
      }

      .card-custom:hover {
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }

      .card-header-custom {
        background: white;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        padding: 1.5rem;
        border-radius: 0.5rem 0.5rem 0 0;
      }

      .stat-card {
        position: relative;
        overflow: hidden;
      }

      .stat-card::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 100px;
        height: 100%;
        background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.1));
        transform: skewX(-15deg);
      }

      .stat-icon {
        font-size: 2.5rem;
        opacity: 0.8;
        transition: transform 0.3s ease;
      }

      .card-custom:hover .stat-icon {
        transform: scale(1.1);
      }

      .btn-custom {
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        font-weight: 500;
        transition: all 0.3s ease;
      }

      .btn-primary {
        background: var(--primary-color);
        border-color: var(--primary-color);
      }

      .btn-primary:hover {
        background: var(--primary-dark);
        border-color: var(--primary-dark);
      }

      .btn-custom-primary {
        background: var(--primary-color);
        border-color: var(--primary-color);
        color: white;
      }

      .btn-custom-primary:hover {
        background: var(--primary-dark);
        border-color: var(--primary-dark);
        color: white;
      }

      .btn-outline-custom {
        color: var(--primary-color);
        border-color: var(--primary-color);
        background-color: transparent;
      }

      .btn-outline-custom:hover {
        color: white;
        background-color: var(--primary-color);
        border-color: var(--primary-color);
      }

      .btn-custom:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
      }

      .action-card {
        border-radius: 0.5rem;
        border: 1px solid rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
      }

      .action-card:hover {
        background: white;
        transform: translateY(-5px);
        box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.1);
      }

      /* Table Styles */
      .table-container {
        background: white;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        overflow: hidden;
      }

      .table {
        margin-bottom: 0;
      }

      .table thead th {
        background: var(--sidebar-bg);
        color: var(--text-primary);
        font-weight: 500;
        border: none;
        padding: 1rem 1.5rem;
        font-size: 0.875rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .table tbody td {
        padding: 1rem 1.5rem;
        border-bottom: 1px solid rgba(0,0,0,0.05);
        vertical-align: middle;
      }

      /* Dropdown Styles */
      .dropdown-menu {
        border: none;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      }

      .dropdown-item {
        padding: 0.5rem 1rem;
      }

      .dropdown-item:hover {
        background: var(--body-bg);
      }

      /* Badge Styles */
      .badge-success {
        background-color: var(--success-color);
        color: white;
      }

      .badge-warning {
        background-color: var(--warning-color);
        color: white;
      }

      .badge-danger {
        background-color: var(--danger-color);
        color: white;
      }

      @media (max-width: 768px) {
        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.show {
          transform: translateX(0);
        }

        .main-content {
          margin-left: 0;
        }

        .sidebar-backdrop {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 999;
        }

        .sidebar-backdrop.show {
          display: block;
        }
      }
    </style>

    <%= yield :styles %>
  </head>

  <body>
    <div data-controller="sidebar">
      <!-- Sidebar -->
      <nav class="sidebar" data-sidebar-target="content">
        <div class="sidebar-brand d-flex align-items-center justify-content-center">
          <div class="sidebar-brand-icon">
            <i class="bi bi-buildings-fill text-white fs-4"></i>
          </div>
          <div class="sidebar-brand-text text-white ms-2 fw-bold">SOUL ERP</div>
        </div>

        <hr class="sidebar-divider my-2 opacity-25">

        <ul class="nav flex-column">
          <li class="nav-item">
            <%= link_to admin_root_path, class: "nav-link #{active_link?('dashboard')}" do %>
              <i class="bi bi-speedometer2"></i>
              <span>Dashboard</span>
            <% end %>
          </li>

          <li class="nav-item">
            <%= link_to admin_institutes_path, class: "nav-link #{active_link?('institutes')}" do %>
              <i class="bi bi-building"></i>
              <span>Institutes</span>
            <% end %>
          </li>

          <li class="nav-item">
            <%= link_to admin_users_path, class: "nav-link #{active_link?('users')}" do %>
              <i class="bi bi-people"></i>
              <span>Institute Admins</span>
            <% end %>
          </li>

          <li class="nav-item">
            <%= link_to edit_admin_registration_setting_path, class: "nav-link #{active_link?('registration_settings')}" do %>
              <i class="bi bi-gear"></i>
              <span>Settings</span>
            <% end %>
          </li>
        </ul>

        <hr class="sidebar-divider my-2 opacity-25">

        <div class="px-3 mt-4">
          <%= button_to destroy_user_session_path, method: :delete, 
              class: "btn btn-outline-light w-100 d-flex align-items-center justify-content-center gap-2" do %>
            <i class="bi bi-box-arrow-right"></i>
            <span>Sign Out</span>
          <% end %>
        </div>
      </nav>

      <!-- Backdrop for mobile -->
      <div class="sidebar-backdrop" data-sidebar-target="backdrop" data-action="click->sidebar#hide"></div>

      <!-- Main Content -->
      <div class="main-content">
        <!-- Topbar -->
        <nav class="topbar navbar navbar-expand navbar-light">
          <div class="container-fluid">
            <!-- Sidebar Toggle -->
            <button class="btn btn-link d-md-none" data-action="click->sidebar#toggle">
              <i class="bi bi-list"></i>
            </button>

            <!-- User Info -->
            <ul class="navbar-nav ms-auto">
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                  <span class="d-none d-lg-inline text-gray-600 small me-1"><%= current_user.email %></span>
                  <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center" 
                       style="width: 32px; height: 32px;">
                    <%= current_user.first_name&.first || current_user.email.first.upcase %>
                  </div>
                </a>
                <ul class="dropdown-menu dropdown-menu-end">
                  <li>
                    <%= button_to destroy_user_session_path, method: :delete, class: "dropdown-item" do %>
                      <i class="bi bi-box-arrow-right me-1"></i> Sign Out
                    <% end %>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </nav>

        <!-- Page Content -->
        <div class="container-fluid p-4">
          <%= yield %>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html> 