<div class="container-fluid py-4">
  <!-- Profile Overview Card -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="card card-custom shadow-sm">
        <div class="card-body">
          <div class="row align-items-center">
            <div class="col-md-2 text-center">
              <div class="rounded-circle bg-primary text-white d-inline-flex align-items-center justify-content-center" style="width: 80px; height: 80px;">
                <span class="h3 mb-0"><%= current_user.first_name&.first&.upcase || current_user.email.first.upcase %></span>
              </div>
            </div>
            <div class="col-md-5">
              <h4 class="mb-1"><%= current_user.first_name.present? ? "#{current_user.first_name} #{current_user.last_name}" : current_user.email %></h4>
              <p class="text-muted mb-0">
                <i class="bi bi-building me-2"></i><%= current_institute.name %>
                <% if current_participant.section %>
                  <span class="mx-2">|</span>
                  <i class="bi bi-diagram-2 me-2"></i><%= current_participant.section.name %>
                <% end %>
              </p>
            </div>
            <div class="col-md-5">
              <div class="row text-center">
                <div class="col-4">
                  <h5 class="mb-1"><%= @training_programs.completed.count %></h5>
                  <p class="text-muted mb-0">Completed</p>
                </div>
                <div class="col-4">
                  <h5 class="mb-1"><%= @training_programs.ongoing.count %></h5>
                  <p class="text-muted mb-0">Ongoing</p>
                </div>
                <div class="col-4">
                  <h5 class="mb-1"><%= @training_programs.count %></h5>
                  <p class="text-muted mb-0">Total Programs</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Training Programs and Personal Info -->
  <div class="row">
    <!-- Training Programs -->
    <div class="col-md-8">
      <div class="card card-custom shadow-sm">
        <div class="card-header card-header-custom">
          <h5 class="mb-0">My Training Programs</h5>
        </div>
        <div class="card-body">
          <% if @training_programs.any? %>
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Program</th>
                    <th>Trainer</th>
                    <th>Status</th>
                    <th>Progress</th>
                  </tr>
                </thead>
                <tbody>
                  <% @training_programs.each do |program| %>
                    <tr>
                      <td>
                        <strong><%= program.name %></strong>
                        <br>
                        <small class="text-muted"><%= program.description&.truncate(50) %></small>
                      </td>
                      <td>
                        <%= program.trainer.user.first_name.present? ? 
                            "#{program.trainer.user.first_name} #{program.trainer.user.last_name}" : 
                            program.trainer.user.email %>
                      </td>
                      <td>
                        <span class="badge <%= program.status == 'completed' ? 'bg-success' : 'bg-primary' %>">
                          <%= program.status.titleize %>
                        </span>
                      </td>
                      <td>
                        <div class="progress" style="height: 10px;">
                          <div class="progress-bar bg-success" 
                               role="progressbar" 
                               style="width: <%= program.progress || 0 %>%" 
                               aria-valuenow="<%= program.progress || 0 %>" 
                               aria-valuemin="0" 
                               aria-valuemax="100">
                          </div>
                        </div>
                        <small class="text-muted"><%= program.progress || 0 %>% Complete</small>
                      </td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          <% else %>
            <div class="text-center py-4">
              <i class="bi bi-journal-x h1 text-muted"></i>
              <p class="text-muted mt-2">No training programs assigned yet.</p>
            </div>
          <% end %>
        </div>
      </div>
    </div>

    <!-- Personal Info & Stats -->
    <div class="col-md-4">
      <!-- Personal Info Card -->
      <div class="card card-custom shadow-sm mb-4">
        <div class="card-header card-header-custom">
          <h5 class="mb-0">Personal Information</h5>
        </div>
        <div class="card-body">
          <ul class="list-unstyled">
            <li class="mb-3">
              <i class="bi bi-envelope me-2 text-muted"></i>
              <%= current_user.email %>
            </li>
            <li class="mb-3">
              <i class="bi bi-calendar me-2 text-muted"></i>
              Date of Birth: <%= current_participant.date_of_birth&.strftime("%B %d, %Y") %>
            </li>
            <li class="mb-3">
              <i class="bi bi-book me-2 text-muted"></i>
              Education: <%= current_participant.education_level %>
            </li>
            <li class="mb-3">
              <i class="bi bi-calendar-check me-2 text-muted"></i>
              Enrolled: <%= current_participant.enrollment_date&.strftime("%B %d, %Y") %>
            </li>
            <li>
              <i class="bi bi-person-badge me-2 text-muted"></i>
              Status: <span class="badge bg-success"><%= current_participant.status.titleize %></span>
            </li>
          </ul>
        </div>
      </div>

      <!-- Quick Stats Card -->
      <div class="card card-custom shadow-sm">
        <div class="card-header card-header-custom">
          <h5 class="mb-0">Quick Stats</h5>
        </div>
        <div class="card-body">
          <div class="row text-center">
            <div class="col-6 mb-3">
              <div class="p-3 rounded bg-light">
                <i class="bi bi-calendar-check h3 text-success"></i>
                <h6 class="mt-2 mb-1"><%= @training_programs.completed.count %></h6>
                <p class="small text-muted mb-0">Programs Completed</p>
              </div>
            </div>
            <div class="col-6 mb-3">
              <div class="p-3 rounded bg-light">
                <i class="bi bi-play-circle h3 text-primary"></i>
                <h6 class="mt-2 mb-1"><%= @training_programs.ongoing.count %></h6>
                <p class="small text-muted mb-0">Programs Ongoing</p>
              </div>
            </div>
            <div class="col-6">
              <div class="p-3 rounded bg-light">
                <i class="bi bi-clock-history h3 text-warning"></i>
                <h6 class="mt-2 mb-1"><%= current_participant.all_training_programs.sum { |p| ((p.end_date.to_i - p.start_date.to_i) / 3600.0).round if p.start_date && p.end_date } || 0 %></h6>
                <p class="small text-muted mb-0">Total Hours</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>